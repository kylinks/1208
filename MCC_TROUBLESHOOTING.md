# MCC é…ç½®é—®é¢˜æ’æŸ¥æŒ‡å—

## å½“å‰é—®é¢˜

éªŒè¯ MCC æ—¶å‡ºç°é”™è¯¯ï¼š`MCC è´¦æˆ·ä¸å­˜åœ¨æˆ–æ— æ³•è®¿é—®`

## ğŸ” æ’æŸ¥æ­¥éª¤

### 1ï¸âƒ£ æ£€æŸ¥é…ç½®æ–‡ä»¶

å·²ç¡®è®¤ âœ…ï¼š
- GOOGLE_ADS_DEVELOPER_TOKEN: å·²è®¾ç½®
- GOOGLE_SERVICE_ACCOUNT_KEY_PATH: å·²è®¾ç½®
- æœåŠ¡è´¦å·å¯†é’¥æ–‡ä»¶: å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®
- æœåŠ¡è´¦å·é‚®ç®±: `kyads-758@glassy-rush-474806-n7.iam.gserviceaccount.com`

### 2ï¸âƒ£ æ£€æŸ¥ Google Ads æƒé™

**è¿™æ˜¯æœ€å¯èƒ½çš„é—®é¢˜ï¼** æœåŠ¡è´¦å·éœ€è¦åœ¨ Google Ads MCC ä¸­è¢«æˆæƒã€‚

#### æ“ä½œæ­¥éª¤ï¼š

1. **ç™»å½• Google Ads**
   - è®¿é—®ï¼šhttps://ads.google.com
   - ä½¿ç”¨æœ‰ç®¡ç†å‘˜æƒé™çš„è´¦å·ç™»å½• MCC `968-646-8564`

2. **æ·»åŠ æœåŠ¡è´¦å·ç”¨æˆ·**
   ```
   å·¥å…·å’Œè®¾ç½® ğŸ”§ 
   â†’ è®¾ç½® 
   â†’ è®¿é—®æƒé™å’Œå®‰å…¨ 
   â†’ è®¿é—®æƒé™ï¼ˆç”¨æˆ·ï¼‰
   â†’ ç‚¹å‡» "+" æ·»åŠ ç”¨æˆ·
   ```

3. **å¡«å†™ä¿¡æ¯**
   - **ç”µå­é‚®ä»¶åœ°å€**: `kyads-758@glassy-rush-474806-n7.iam.gserviceaccount.com`
   - **è®¿é—®çº§åˆ«**: é€‰æ‹© **"æ ‡å‡†è®¿é—®"** æˆ– **"ç®¡ç†å‘˜"**
   - **æ¥æ”¶ç”µå­é‚®ä»¶æé†’å’Œé€šçŸ¥**: å–æ¶ˆå‹¾é€‰ï¼ˆæœåŠ¡è´¦å·ä¸éœ€è¦ï¼‰

4. **ä¿å­˜å¹¶ç­‰å¾…**
   - ç‚¹å‡»ã€Œå‘é€é‚€è¯·ã€
   - **é‡è¦**: æœåŠ¡è´¦å·ä¼šè‡ªåŠ¨è·å¾—è®¿é—®æƒé™ï¼Œæ— éœ€æ‰‹åŠ¨æ¥å—é‚€è¯·
   - ç­‰å¾… 1-2 åˆ†é’Ÿè®©æƒé™ç”Ÿæ•ˆ

### 3ï¸âƒ£ æ£€æŸ¥ Developer Token çŠ¶æ€

Developer Token æœ‰ä¸¤ç§çŠ¶æ€ï¼š
- **æµ‹è¯•æ¨¡å¼** - åªèƒ½è®¿é—®è‡ªå·±çš„è´¦æˆ·
- **å·²æ‰¹å‡†** - å¯ä»¥è®¿é—®æˆæƒçš„æ‰€æœ‰è´¦æˆ·

#### æ£€æŸ¥æ­¥éª¤ï¼š

1. **è®¿é—® Google Ads API Center**
   - ç™»å½•ï¼šhttps://ads.google.com/aw/apicenter
   - æŸ¥çœ‹ Developer Token çŠ¶æ€

2. **å¦‚æœæ˜¯"æµ‹è¯•æ¨¡å¼"**
   - åœ¨æµ‹è¯•æ¨¡å¼ä¸‹ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€ï¼š
     - Developer Token æ‰€å±çš„è´¦å·å°±æ˜¯ MCC `968-646-8564` æœ¬èº«
     - æˆ–è€…ç”³è¯·å°† Token å‡çº§ä¸º"ç”Ÿäº§ç¯å¢ƒ"çŠ¶æ€

3. **ç”³è¯·ç”Ÿäº§ç¯å¢ƒè®¿é—®ï¼ˆå¦‚æœéœ€è¦ï¼‰**
   - å¡«å†™ Google Ads API è®¿é—®ç”³è¯·è¡¨
   - è¯´æ˜ä½¿ç”¨ç›®çš„
   - é€šå¸¸éœ€è¦ 1-2 ä¸ªå·¥ä½œæ—¥å®¡æ‰¹

### 4ï¸âƒ£ æ£€æŸ¥ MCC ID æ ¼å¼

ç¡®è®¤ MCC ID `968-646-8564` æ˜¯å¦æ­£ç¡®ï¼š
- âœ… æ ¼å¼æ­£ç¡®ï¼š`xxx-xxx-xxxx`
- â“ è¿™ä¸ª MCC ID çœŸçš„å­˜åœ¨å—ï¼Ÿ
- â“ ä½ çš„è´¦å·æœ‰æƒè®¿é—®è¿™ä¸ª MCC å—ï¼Ÿ

### 5ï¸âƒ£ æ£€æŸ¥ API ç‰ˆæœ¬

å½“å‰ä½¿ç”¨çš„ API ç‰ˆæœ¬ï¼š`v17`

å¦‚æœéœ€è¦æ›´æ”¹ç‰ˆæœ¬ï¼Œä¿®æ”¹ `lib/googleAdsService.ts`ï¼š
```typescript
private apiVersion: string = 'v17'; // æ”¹ä¸º 'v16' æˆ–å…¶ä»–ç‰ˆæœ¬
```

æœ€æ–°ç‰ˆæœ¬æŸ¥è¯¢ï¼šhttps://developers.google.com/google-ads/api/docs/release-notes

### 6ï¸âƒ£ æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—

é‡å¯å¼€å‘æœåŠ¡å™¨åï¼ŒæŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼š

```bash
# åœæ­¢å½“å‰æœåŠ¡å™¨ (Ctrl+C)
# é‡æ–°å¯åŠ¨
npm run dev
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­é‡æ–°å°è¯•éªŒè¯ MCCï¼ŒæŸ¥çœ‹ç»ˆç«¯è¾“å‡ºçš„è¯¦ç»†æ—¥å¿—ï¼š

```
ğŸ” åˆå§‹åŒ– Google Ads æœåŠ¡...
âœ… Google Ads æœåŠ¡åˆå§‹åŒ–æˆåŠŸ
ğŸ“¡ è°ƒç”¨ Google Ads API: { url: '...', mccId: '...', hasToken: true }
ğŸ“¥ API å“åº”çŠ¶æ€: { status: 404, statusText: 'Not Found', ok: false }
âŒ Google Ads API é”™è¯¯å“åº”: { ... }
```

**å…³é”®ä¿¡æ¯**ï¼š
- `status`: HTTP çŠ¶æ€ç 
- `responseText`: è¯¦ç»†é”™è¯¯ä¿¡æ¯

### 7ï¸âƒ£ å¸¸è§é”™è¯¯ç å«ä¹‰

| çŠ¶æ€ç  | å«ä¹‰ | è§£å†³æ–¹æ¡ˆ |
|--------|------|---------|
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ | æ£€æŸ¥ MCC ID æ ¼å¼ã€GAQL æŸ¥è¯¢è¯­æ³• |
| 401 | è®¤è¯å¤±è´¥ | æ£€æŸ¥ Developer Tokenã€è®¿é—®ä»¤ç‰Œ |
| 403 | æƒé™ä¸è¶³ | åœ¨ MCC ä¸­æ·»åŠ æœåŠ¡è´¦å· |
| 404 | MCC ä¸å­˜åœ¨ | ç¡®è®¤ MCC ID æ˜¯å¦æ­£ç¡® |

### 8ï¸âƒ£ æµ‹è¯• API è¿æ¥

ä½¿ç”¨ curl æµ‹è¯• Google Ads API è¿æ¥ï¼š

```bash
# å…ˆè·å–è®¿é—®ä»¤ç‰Œ
node -e "
const { GoogleAuth } = require('google-auth-library');
(async () => {
  const auth = new GoogleAuth({
    keyFile: './config/service-account-key.json',
    scopes: ['https://www.googleapis.com/auth/adwords'],
  });
  const client = await auth.getClient();
  const token = await client.getAccessToken();
  console.log(token.token);
})();
"

# ä½¿ç”¨è·å–çš„ token æµ‹è¯• APIï¼ˆæ›¿æ¢ä¸‹é¢çš„ YOUR_TOKEN å’Œ YOUR_DEVELOPER_TOKENï¼‰
curl -X POST \
  https://googleads.googleapis.com/v22/customers/9686468564/googleAds:search \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "developer-token: YOUR_DEVELOPER_TOKEN" \
  -H "login-customer-id: 9686468564" \
  -H "Content-Type: application/json" \
  -d '{
    "query": "SELECT customer_client.id, customer_client.descriptive_name FROM customer_client WHERE customer_client.level <= 1"
  }'
```

## ğŸ“‹ å®Œæ•´æ£€æŸ¥æ¸…å•

åœ¨é‡æ–°æµ‹è¯•ä¹‹å‰ï¼Œç¡®ä¿ï¼š

- [ ] æœåŠ¡è´¦å· `kyads-758@glassy-rush-474806-n7.iam.gserviceaccount.com` å·²åœ¨ Google Ads MCC ä¸­æ·»åŠ 
- [ ] æœåŠ¡è´¦å·çš„è®¿é—®çº§åˆ«ä¸ºã€Œæ ‡å‡†è®¿é—®ã€æˆ–ã€Œç®¡ç†å‘˜ã€
- [ ] ç­‰å¾…è‡³å°‘ 2 åˆ†é’Ÿè®©æƒé™ç”Ÿæ•ˆ
- [ ] Developer Token ä¸æ˜¯"æµ‹è¯•æ¨¡å¼"ï¼Œæˆ–è€… MCC å°±æ˜¯ Token æ‰€å±çš„è´¦å·
- [ ] MCC ID `968-646-8564` ç¡®å®å­˜åœ¨ä¸”ä½ æœ‰æƒè®¿é—®
- [ ] å·²é‡å¯å¼€å‘æœåŠ¡å™¨
- [ ] æŸ¥çœ‹äº†è¯¦ç»†çš„é”™è¯¯æ—¥å¿—

## ğŸ”§ å¿«é€Ÿä¿®å¤å»ºè®®

**æœ€å¯èƒ½çš„åŸå› **: æœåŠ¡è´¦å·æœªè¢«æˆæƒè®¿é—® MCC

**è§£å†³æ–¹æ¡ˆ**:
1. åœ¨ Google Ads MCC ä¸­æ·»åŠ æœåŠ¡è´¦å·ï¼ˆæ­¥éª¤ 2ï¸âƒ£ï¼‰
2. ç­‰å¾… 2 åˆ†é’Ÿ
3. é‡å¯å¼€å‘æœåŠ¡å™¨
4. é‡æ–°æµ‹è¯•

## ğŸ“ éœ€è¦æ›´å¤šå¸®åŠ©ï¼Ÿ

å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **è¯¦ç»†é”™è¯¯æ—¥å¿—**ï¼ˆæ¥è‡ªç»ˆç«¯çš„å®Œæ•´è¾“å‡ºï¼‰
2. **HTTP çŠ¶æ€ç **ï¼ˆä»æ—¥å¿—ä¸­çš„ `API å“åº”çŠ¶æ€` è·å–ï¼‰
3. **é”™è¯¯å“åº”æ–‡æœ¬**ï¼ˆä»æ—¥å¿—ä¸­çš„ `é”™è¯¯å“åº”` è·å–ï¼‰
4. **Developer Token çŠ¶æ€**ï¼ˆæµ‹è¯•æ¨¡å¼ or å·²æ‰¹å‡†ï¼‰
5. **æ˜¯å¦å·²åœ¨ MCC ä¸­æ·»åŠ æœåŠ¡è´¦å·**

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [Google Ads API æ–‡æ¡£](https://developers.google.com/google-ads/api/docs/start)
- [æœåŠ¡è´¦å·è®¤è¯](https://developers.google.com/google-ads/api/docs/oauth/service-accounts)
- [Developer Token ç”³è¯·](https://developers.google.com/google-ads/api/docs/get-started/dev-token)
- [é”™è¯¯ç å‚è€ƒ](https://developers.google.com/google-ads/api/docs/errors)
